

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to Contractor &#8212; t3kton 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Give it a Try" href="tryit/index.html" />
    <link rel="prev" title="Contractor" href="index.html" />

    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159896960-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-159896960-1');
</script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tryit/index.html" title="Give it a Try"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Contractor"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">t3kton 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Contractor</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Contractor</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
<li><a class="reference internal" href="#high-level-look">High Level Look</a><ul>
<li><a class="reference internal" href="#foundations-and-structures">Foundations and Structures</a></li>
<li><a class="reference internal" href="#sites">Sites</a></li>
<li><a class="reference internal" href="#complexes">Complexes</a></li>
<li><a class="reference internal" href="#side-track-to-the-manifesto">Side Track to the Manifesto</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#blueprints">BluePrints</a></li>
<li><a class="reference internal" href="#other">Other</a></li>
<li><a class="reference internal" href="#future">Future</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Contractor</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tryit/index.html"
                        title="next chapter">Give it a Try</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction-to-contractor">
<h1>Introduction to Contractor<a class="headerlink" href="#introduction-to-contractor" title="Permalink to this headline">¶</a></h1>
<p>Contractor is an Extendable Resource Management API.  The goal of Contractor
is to provide an API to Automate the Provisioning, Deployment, Configuration and
Management of Resources.</p>
<p>Contractor uses building terms (for the most part) to try to avoid name
collisions with various platforms and systems.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Contractor is a builder of anything, and is targeted to be used as a generic API
to create/destroy/manipulate your resources no matter where or what they are.
This enables you to focus on what you want to make, and not have to worry about
the details and differences in deployment.</p>
<p>To accomplish this, Contractor breaks deployment/provisioning into two parts.  A
Structure, or what it is you want to deploy, and a Foundation, or what you want
to deploy it on.  Examples of Foundations are VirtualBox VMs, Docker Containers,
Servers with IPMI, Servers with out out-of-band control, Switches, PDUs, AWS, GCD,
or just about anything else.  A Structure would be a DNS server, API Endpoint,
Load Balanacer, Web Server, Docker Host, VirtualBox Host, CoreOS Server, etc.  To
describe a Structure, a BluePrint is used.  This BluePrint describes configuration
information needed to create the Structure.  There are also BluePrints for Foundations,
which describe firmware, machine level configuration (i.e., IPMI configuration ), as
well as contain information to fingerprint foundations, for example a Foundation
BluePrint can require a certain number of CPUs and Memory, PCI devices, as well
as storage details.  Each Structure and Foundation belong to a grouping called
a Site.  Sites can belong to other Sites, and a Structure does not need to belong
to the same Site as its foundation.  The Site can also contain configuration
information that the Structures and Foundations that belong to it inherit.
This way a configuration such as DNS Server can be maintained at the Site level
and automatically propagate to everything inside that Site.</p>
<p>At its core Contractor has a scripting language called TScript.  Each BluePrint
has a Create and Destroy script that is executed to create and destroy that Structure
or in the case of Foundations, provision and de-provision.  Utility scripts can also
be created, for example, if a new firmware for a storage controller is released.
A utility script can be created to deploy this new firmware, and a Job can be created
to execute the script.  Jobs are run by the Foreman subsystem.  When a new Foundation
has been detected, or a Structure’s Foundation has been provisioned, Foreman will
provide instructions to a SubContractor daemon to do individual tasks required
for that Foundation to be Provisioned or Structure to be created.</p>
<p>SubContractor is a daemon that is run in appropriate parts of the network for
handling tasks as requested by the Script being executed in the Job.  All tasks
are asked for by SubContracor, over HTTP (fully proxyable) thus Contractor itself
does not have to have access to sensitive parts of the network, it only
needs to be visible to SubContractor.  Each SubContractor can be configured to
only do certain types of work.  For example, a SubContractor can be configured to
do only IPMI tasks enabling the IPMI network to be isolated from other networks.
Other SubContractors can then handle PXE booting the servers and perform other checks
such as checking to see if port 22 is open (a common and easy way to make sure
a Structure with SSH installed has sucessfully booted).</p>
</div>
</div>
<div class="section" id="high-level-look">
<h1>High Level Look<a class="headerlink" href="#high-level-look" title="Permalink to this headline">¶</a></h1>
<div class="section" id="foundations-and-structures">
<h2>Foundations and Structures<a class="headerlink" href="#foundations-and-structures" title="Permalink to this headline">¶</a></h2>
<p>First two terms are <strong>Foundation</strong> and <strong>Structure</strong>.  A Foundation is something
to build on, a Structure is the thing you want to build.  Say we want to
build a Web Server.  Our Structure is a set of configuration values and scripts
required to build that web server, i.e., Install Ubuntu LTS 18.04 and install and
Configure Apache (more on those details in …..).  The Foundation is what we
want to install that on, i.e., a VM, Container, Blade Server, Bare-metal Server,
Raspberry PI, ECS, GCD, etc…  Not all Foundations are going to be compatible
with all Structures, however a well defined Structure can be installed on most
of them.</p>
<p>So far we have this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+-----------------------------+</span>
<span class="o">|</span>                             <span class="o">|</span>
<span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span>
<span class="o">|</span>                             <span class="o">|</span>
<span class="o">+-----------------------------+</span>
             <span class="o">|</span>
             <span class="o">|</span>
<span class="o">+-----------------------------+</span>
<span class="o">|</span>                             <span class="o">|</span>
<span class="o">|</span>   <span class="n">Foundation</span>                <span class="o">|</span>
<span class="o">|</span>                             <span class="o">|</span>
<span class="o">+-----------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="sites">
<h2>Sites<a class="headerlink" href="#sites" title="Permalink to this headline">¶</a></h2>
<p>The next term is <strong>Site</strong>.  A site is a Logical grouping of things.  Let’s put
our Web Server in a Site called “Cluster 1”</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+-------------------------------------+</span>
<span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">1</span>                          <span class="o">|</span>
<span class="o">|</span>                                     <span class="o">|</span>
<span class="o">|</span>    <span class="o">+-----------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">+------------+----------------+</span>  <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span>                   <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span>                   <span class="o">|</span>
<span class="o">|</span>    <span class="o">+------------+----------------+</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>   <span class="n">Foundation</span>                <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">+-----------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>                                     <span class="o">|</span>
<span class="o">+-------------------------------------+</span>
</pre></div>
</div>
<p>Each Item we have used so far contains configuration values.  These are Key
Value pairs that can be overlay-ed.  In this case Contractor will take the
configuration values of “Cluster 1” then overlay them with “Foundation” and
the “Structure”.</p>
<p>Sites can be be put into other Sites.  For example we have Clusters 1, 2, and 3
in “Datacenter West”.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+---------------------------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">Datacenter</span> <span class="n">West</span>                                                                             <span class="o">|</span>
<span class="o">|</span>                                                                                             <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-------------------------------------+</span> <span class="o">+----------------------+</span> <span class="o">+----------------------+</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">1</span>                          <span class="o">|</span> <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">2</span>           <span class="o">|</span> <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">3</span>           <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                     <span class="o">|</span> <span class="o">|</span>                      <span class="o">|</span> <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">+-----------------------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+--------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+--------------+</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">Structure</span>   <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">Structure</span>   <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">+------------+----------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+-----+--------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+-----+--------+</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                 <span class="o">|</span>                   <span class="o">|</span> <span class="o">|</span>          <span class="o">|</span>           <span class="o">|</span> <span class="o">|</span>          <span class="o">|</span>           <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                 <span class="o">|</span>                   <span class="o">|</span> <span class="o">|</span>          <span class="o">|</span>           <span class="o">|</span> <span class="o">|</span>          <span class="o">|</span>           <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">+------------+----------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+-----+--------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+-----+--------+</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>   <span class="n">Foundation</span>                <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">Foundation</span>  <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>  <span class="n">Foundation</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">|</span>                             <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span>              <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>    <span class="o">+-----------------------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+--------------+</span>  <span class="o">|</span> <span class="o">|</span>    <span class="o">+--------------+</span>  <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                     <span class="o">|</span> <span class="o">|</span>                      <span class="o">|</span> <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-------------------------------------+</span> <span class="o">+----------------------+</span> <span class="o">+----------------------+</span>  <span class="o">|</span>
<span class="o">|</span>                                                                                             <span class="o">|</span>
<span class="o">+---------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>Now the configuration information will first have site “Datacenter West” then,
Cluster X, Foundation, Structure.  This comes in handy for propagating configuration
information without having to set it for each item individually.  For example,
we can have the DNS Search Zones be set to “west.site.com” in the site “Datacenter West”
and prepend that with “cluster1.site.com” in “Cluster 1”.  If at any time we want
some other global DNS search zone, we add it to the top and it automatically propagates
down.  You could also set “Release”=”Prod” in “Datacenter West” and then create a
“Cluster Test” and override the “Release” to the value “Test”.  You could also do
A-B testing, etc.</p>
<p>Any Item can make an HTTP request to Contractor and Contractor will reply with a JSON
encoded reply with that item’s combined configuration values.</p>
<p>This is all fun and all, but not really useful.  Let’s change things up a bit and
install ESX on the bare-metal and put a few Web servers on ESX.</p>
<p>Before we do that we need to dig into Foundations a little more. The <strong>Foundation</strong>
class is meant as a root class for specific target handlers to work against.</p>
<p>We are going to use the <strong>IPMIFoundation</strong> to handle the bare-metal machines on which
we are installing ESX on, and <strong>VCenterFoundation</strong> to handle the vms on the
ESX/VCenter.</p>
</div>
<div class="section" id="complexes">
<h2>Complexes<a class="headerlink" href="#complexes" title="Permalink to this headline">¶</a></h2>
<p>Note: we are going to omit Cluster 2 and 3 for now, they are clones of Cluster 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">Datacenter</span> <span class="n">West</span>                                                             <span class="o">|</span>
<span class="o">|</span>                                                                             <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-----------------------------------------------------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">1</span>                                                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+-----------------------------+</span> <span class="o">+-----------------------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span> <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------+----------------+</span> <span class="o">+------------+----------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>               <span class="o">|</span>                               <span class="o">|</span>                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>               <span class="o">|</span>                               <span class="o">|</span>                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------+----------------+</span> <span class="o">+------------+----------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>   <span class="n">VCenterFoundation</span>         <span class="o">|</span> <span class="o">|</span>   <span class="n">VCenterFoundation</span>         <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------------------+----+</span> <span class="o">+---+-------------------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                           <span class="o">|</span>          <span class="o">|</span>                                <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">+----+----------+---+</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span>                   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span> <span class="n">VCenter</span> <span class="n">Complex</span>   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span>                   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">+--------+----------+</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                               <span class="o">|</span>                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">+------------+----------------+</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>                             <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">ESX</span><span class="p">)</span>            <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>                             <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">+------------+----------------+</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                               <span class="o">|</span>                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                               <span class="o">|</span>                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">+------------+----------------+</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>                             <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>   <span class="n">IPMIFoundation</span>            <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">|</span>                             <span class="o">|</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                  <span class="o">+-----------------------------+</span>                      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-----------------------------------------------------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>                                                                             <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>This introduces our next item the <strong>Complex</strong> as in a building complex.  A Complex
is a group of Structures providing something for more Foundations to be built on.
A Complex (depending on the type) can have one or more Structures as members.
NOTE: the configuration info of the Structure and Foundations that make up a
cluster do <strong>NOT</strong> flow through to the Foundations and Structures built on that
complex.  The Members of the Complex can even belong to another site.</p>
<p>For Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">Datacenter</span> <span class="n">West</span>                                                             <span class="o">|</span>
<span class="o">|</span>                                                                             <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-----------------------------------------------------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">1</span>                                                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+-----------------------------+</span> <span class="o">+-----------------------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span> <span class="o">|</span>  <span class="n">Structure</span> <span class="p">(</span><span class="n">Web</span> <span class="n">Server</span><span class="p">)</span>     <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------+----------------+</span> <span class="o">+------------+----------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>               <span class="o">|</span>                               <span class="o">|</span>                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>               <span class="o">|</span>                               <span class="o">|</span>                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------+----------------+</span> <span class="o">+------------+----------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>   <span class="n">VCenterFoundation</span>         <span class="o">|</span> <span class="o">|</span>   <span class="n">VCenterFoundation</span>         <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>                             <span class="o">|</span> <span class="o">|</span>                             <span class="o">|</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="o">+------------------------+----+</span> <span class="o">+---+-------------------------+</span>      <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                           <span class="o">|</span>          <span class="o">|</span>                                <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-----------------------------------------------------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                           <span class="o">|</span>          <span class="o">|</span>                                <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>  <span class="n">Cluster</span> <span class="mi">1</span> <span class="n">Hosting</span>   <span class="o">+----+----------+---+</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span>                   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span> <span class="n">VCenter</span> <span class="n">Complex</span>   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">|</span>                   <span class="o">|</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                      <span class="o">+---+-------------+-+</span>                            <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                          <span class="o">|</span>             <span class="o">|</span>                              <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                          <span class="o">|</span>             <span class="o">|</span>                              <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                          <span class="o">|</span>             <span class="o">|</span>                              <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                          <span class="o">|</span>             <span class="o">|</span>                              <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">+--------------------+------+</span>   <span class="o">+--+-------------------------+</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span>                           <span class="o">|</span>   <span class="o">|</span>                            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span> <span class="n">Structure</span> <span class="p">(</span><span class="n">ESX</span><span class="p">)</span>           <span class="o">|</span>   <span class="o">|</span> <span class="n">Structure</span> <span class="p">(</span><span class="n">ESX</span><span class="p">)</span>            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span>                           <span class="o">|</span>   <span class="o">|</span>                            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">+----------+----------------+</span>   <span class="o">+-----------+----------------+</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                <span class="o">|</span>                                <span class="o">|</span>                     <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                <span class="o">|</span>                                <span class="o">|</span>                     <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">+----------+----------------+</span>   <span class="o">+-----------+----------------+</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span>                           <span class="o">|</span>   <span class="o">|</span>                            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span>  <span class="n">IPMIFoundation</span>           <span class="o">|</span>   <span class="o">|</span>  <span class="n">IPMIFoundation</span>            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">|</span>                           <span class="o">|</span>   <span class="o">|</span>                            <span class="o">|</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>     <span class="o">+---------------------------+</span>   <span class="o">+----------------------------+</span>    <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">|</span>                                                                       <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="o">+-----------------------------------------------------------------------+</span>  <span class="o">|</span>
<span class="o">|</span>                                                                             <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>Complexes also cause Contractor to build the Web Server Structure/Foundations
after the ESX Structure/Foundations are done.  Also the example would look pretty
much the same for a Docker/OpenStack/etc Complex.</p>
</div>
<div class="section" id="side-track-to-the-manifesto">
<h2>Side Track to the Manifesto<a class="headerlink" href="#side-track-to-the-manifesto" title="Permalink to this headline">¶</a></h2>
<p>At this point you are probably wondering how having all these Foundation types
is simplifying deployments.  By separating the configuration of the “Hosted” and
the “Host” we can effectively divide up the job of configuring the system.  (Do
I get to drop the DevOps Buzzword now?)  As a Developer/Engineer configures their
code, they embody that in a Structure.  They can package that configuration
information along with their code/designs and that configuration can also
be tested and verified via CICD and similar work flows.  This way the very
same configuration information is for all stages of deployment.  It is true
that some Foundations require different considerations, however a well designed
Structure Configuration can work for Containers (and the like) as well as
OS installers (Baremetal/VM/Blade/AWS/Container, etc.)  Now when the Operations
people need to turn it up to 11 (or 12) they just pick the location to deploy
and no matter if it is hosted on premise in VMs, or deployed to AWS for some
peak load handling, Operations can scale as needed, to whatever.</p>
<p>Also by allowing every thing, no matter the platform, to be tracked in the same
place, you now have a single source of truth for your monitoring system to rely on.
You don’t have to worry about parts of your Micro Services failing to auto-register.
And, you know exactly what is deployed where; useful when hardware needs to be
swapped out.</p>
<p>Your Operations teams are also free to try changing out hosting solutions without
retooling everything to try it – in some cases without involving Engineering
to do so.</p>
<p>Not only can you unify your provisioning tools, but also the auto-scaling tools.</p>
<p>You are also free from vendor lock in.  If a new Cloud provider comes along, they
don’t need to have an AWS like API to use them, just a Foundation subclass
provider that talks to that Cloud provider’s API and you are set.  Same if
a new class of hardware comes along (ARM servers anyone?) or a new way of
approaching hosting (the next thing after containers).  And you don’t have to try to
fit all your use cases into one silver bullet.  You can have a nice auto-scaling
Container Cloud/Swarm with your micro services right next to standard VMs running
the databases and object storage.  All with one “pane of glass”</p>
<p>Ok, back to business, buzzword dropping disabled…</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>One final piece of the deployment puzzle, the <strong>Dependency</strong>.  This is to make sure
your deployments happen in order.  For example, you can’t install any OSes until
the Switch is provisioned.  Also you may have to allocate space on an NFS mount
before installing a VM.  This is where Dependencies come in, allowing a Foundation
to Depend on a Structure being built, and/or a job being run on a Structure.</p>
</div>
<div class="section" id="blueprints">
<h2>BluePrints<a class="headerlink" href="#blueprints" title="Permalink to this headline">¶</a></h2>
<p>Now that we have talked about the parts, we need to talk about how those things
are confugred and that is handled by <strong>BluePrint</strong>, specifically the
<strong>FoundationBluePrint</strong> and the <strong>StructureBluePrint</strong>.  A Blueprint also holds
configuration values, as well as links to scripts which are executed when the
Structure/Foundation that blueprint is for is configured, destroyed, or had a named
script run on it.  The BluePrint is the thing that Engineering and Operations
build to embody the process and configuration information of Creating the
Structure/Foundation.</p>
<p>A <strong>BluePrint</strong> can have multiple parents, this is useful for centralizing
configuration information.</p>
<p>A Blueprint must have (or one through it’s parents) two <strong>Scripts</strong>.  A
“create” and a “destroy” script.  I can also have other named scripts
for other tasks.  These scripts are written in <strong>tscript</strong> (see <a class="reference internal" href="tscript.html"><span class="doc">tscript</span></a>).</p>
<p>Taking our example from above, the blueprint for the webserver would look something
like (see :doc:ConfigurationValues for info on the configuration values):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">structure</span><span class="o">.</span><span class="n">webserver</span> <span class="p">]</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;My Serbserver&#39;</span>
  <span class="n">parents</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;ubuntu-bionic-base&#39;</span> <span class="p">]</span>
<span class="p">[</span> <span class="n">structure</span><span class="o">.</span><span class="n">webserver</span><span class="o">.</span><span class="n">config_values</span> <span class="p">]</span>
  <span class="s1">&#39;&gt;package_list&#39;</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;apache&#39;</span><span class="p">,</span> <span class="s1">&#39;myapp&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<p>It would inherit the create/destroy scripts from <cite>linux-installer</cite>, which is an
ancestor to <cite>ubuntu-bionic-base</cite> which is defined in <a class="reference external" href="https://github.com/T3kton/resources/blob/master/os-bases/ubuntu/usr/lib/contractor/resources/ubuntu.toml">https://github.com/T3kton/resources/blob/master/os-bases/ubuntu/usr/lib/contractor/resources/ubuntu.toml</a>.
<cite>linux-installer</cite> is defined here <a class="reference external" href="https://github.com/T3kton/resources/blob/master/os-bases/os_base/usr/lib/contractor/resources/base_os.toml">https://github.com/T3kton/resources/blob/master/os-bases/os_base/usr/lib/contractor/resources/base_os.toml</a>.</p>
</div>
<div class="section" id="other">
<h2>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h2>
<p>There are other Classes/Components in Contractor, but they are mostly for dealing
with Configure/Destroy/Misc Jobs (the Foreman/SubContractor module), or managing
DNS Zones (Directory module), keeping track of Ip Addresses and other
“Utilities” in the Utilities module, the physical location of things (Survey Module),
and Audit log (Records Module).  Those are documented else where.</p>
</div>
<div class="section" id="future">
<h2>Future<a class="headerlink" href="#future" title="Permalink to this headline">¶</a></h2>
<p>Contractor being able to build everything can also be used as a single source of
truth, thus providing a place where you can ask questions such as “How many Load
Balancers do we have”, “What Services will taking this host down affect”, or
“How many VM resources are being used to support this service”.  Contractor has a
Bind zone file generating ability that can be used to maintain DNS records, which
will automatically update when things are added/removed.  With Contractor you do
not have to wait for a new VM to register with a service.  That Service can query
Contractor to know what should be registered with it and act if a registered
resource is not connected.  Contractor will also have webhooks so that services can
be notified on Creation/Destruction events or even hardware events, thus allowing
a service able to ask for a harddrive replacment to wait until it is able
to take that harddrive out of service nicely.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tryit/index.html" title="Give it a Try"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Contractor"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">t3kton 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Contractor</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Peter Howe.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
    </div>
  </body>
</html>